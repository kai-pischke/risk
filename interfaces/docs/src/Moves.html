<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Moves
Description : Core game logic.
Maintainer  : Alex

The basic implementation of the rules for the game, verifying individual actions that manipulate the state.
-}</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Moves</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="RiskBoard.html#Country"><span class="hs-identifier">Country</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Moves.html#reinforce"><span class="hs-identifier">reinforce</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Moves.html#attack"><span class="hs-identifier">attack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Moves.html#chooseDefenders"><span class="hs-identifier">chooseDefenders</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Moves.html#invade"><span class="hs-identifier">invade</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Moves.html#endAttack"><span class="hs-identifier">endAttack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Moves.html#fortify"><span class="hs-identifier">fortify</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Moves.html#skipFortify"><span class="hs-identifier">skipFortify</span></a></span><span>
</span><span id="line-17"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-comment">---- Imports --------------------------------</span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Battle.html"><span class="hs-identifier">Battle</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="State.html"><span class="hs-identifier">State</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="RiskBoard.html"><span class="hs-identifier">RiskBoard</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GameElements.html"><span class="hs-identifier">GameElements</span></a></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random</span></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Array.ST</span></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.ST</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.STRef</span></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-comment">---------------------------------------------</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-comment">---- Helper Functions ------------------------</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="Moves.html#currPlayer"><span class="hs-identifier hs-type">currPlayer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameElements.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span id="currPlayer"><span class="annot"><span class="annottext">currPlayer :: GameState -&gt; Player
</span><a href="Moves.html#currPlayer"><span class="hs-identifier hs-var hs-var">currPlayer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Player] -&gt; Player
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span class="annot"><span class="annottext">([Player] -&gt; Player)
-&gt; (GameState -&gt; [Player]) -&gt; GameState -&gt; Player
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">GameState -&gt; [Player]
</span><a href="State.html#turnOrder"><span class="hs-identifier hs-var">turnOrder</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-comment">--change later to  calculate continent bonuses</span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><a href="Moves.html#nReinforcements"><span class="hs-identifier hs-type">nReinforcements</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameElements.html#TradeIn"><span class="hs-identifier hs-type">TradeIn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameElements.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-39"></span><span>  </span><span id="nReinforcements"><span class="annot"><span class="annottext">nReinforcements :: GameState -&gt; TradeIn -&gt; Player -&gt; Int
</span><a href="Moves.html#nReinforcements"><span class="hs-identifier hs-var hs-var">nReinforcements</span></a></span></span><span> </span><span id="local-6989586621679127759"><span class="annot"><span class="annottext">g :: GameState
</span><a href="#local-6989586621679127759"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679127758"><span class="annot"><span class="annottext">t :: TradeIn
</span><a href="#local-6989586621679127758"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679127757"><span class="annot"><span class="annottext">p :: Player
</span><a href="#local-6989586621679127757"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TradeIn -&gt; Int
</span><a href="Moves.html#tradeInBonus"><span class="hs-identifier hs-var">tradeInBonus</span></a></span><span> </span><span class="annot"><span class="annottext">TradeIn
</span><a href="#local-6989586621679127758"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Player -&gt; Int
</span><a href="Moves.html#territoryBonus"><span class="hs-identifier hs-var">territoryBonus</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127759"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679127757"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Player -&gt; Int
</span><a href="Moves.html#continentBonus"><span class="hs-identifier hs-var">continentBonus</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127759"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679127757"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><a href="Moves.html#tradeInBonus"><span class="hs-identifier hs-type">tradeInBonus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameElements.html#TradeIn"><span class="hs-identifier hs-type">TradeIn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-42"></span><span>  </span><span id="tradeInBonus"><span class="annot"><span class="annottext">tradeInBonus :: TradeIn -&gt; Int
</span><a href="Moves.html#tradeInBonus"><span class="hs-identifier hs-var hs-var">tradeInBonus</span></a></span></span><span> </span><span class="annot"><a href="GameElements.html#None"><span class="hs-identifier hs-type">None</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><a href="Moves.html#tradeInBonus"><span class="hs-identifier hs-var">tradeInBonus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameElements.html#OneSet"><span class="hs-identifier hs-type">OneSet</span></a></span><span> </span><span id="local-6989586621679127750"><span class="annot"><span class="annottext">s :: CardSet
</span><a href="#local-6989586621679127750"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CardSet -&gt; Int
forall p. (Num p, Ord p) =&gt; CardSet -&gt; p
</span><a href="Moves.html#getValue"><span class="hs-identifier hs-var">getValue</span></a></span><span> </span><span class="annot"><span class="annottext">CardSet
</span><a href="#local-6989586621679127750"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><a href="Moves.html#tradeInBonus"><span class="hs-identifier hs-var">tradeInBonus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameElements.html#TwoSet"><span class="hs-identifier hs-type">TwoSet</span></a></span><span> </span><span id="local-6989586621679127747"><span class="annot"><span class="annottext">s1 :: CardSet
</span><a href="#local-6989586621679127747"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621679127746"><span class="annot"><span class="annottext">s2 :: CardSet
</span><a href="#local-6989586621679127746"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CardSet -&gt; Int
forall p. (Num p, Ord p) =&gt; CardSet -&gt; p
</span><a href="Moves.html#getValue"><span class="hs-identifier hs-var">getValue</span></a></span><span> </span><span class="annot"><span class="annottext">CardSet
</span><a href="#local-6989586621679127747"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">CardSet -&gt; Int
forall p. (Num p, Ord p) =&gt; CardSet -&gt; p
</span><a href="Moves.html#getValue"><span class="hs-identifier hs-var">getValue</span></a></span><span> </span><span class="annot"><span class="annottext">CardSet
</span><a href="#local-6989586621679127746"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span>  </span><span id="getValue"><span class="annot"><span class="annottext">getValue :: CardSet -&gt; p
</span><a href="Moves.html#getValue"><span class="hs-identifier hs-var hs-var">getValue</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameElements.html#Infantry"><span class="hs-identifier hs-type">Infantry</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GameElements.html#Infantry"><span class="hs-identifier hs-type">Infantry</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GameElements.html#Infantry"><span class="hs-identifier hs-type">Infantry</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">4</span></span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><a href="Moves.html#getValue"><span class="hs-identifier hs-var">getValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameElements.html#Cavalry"><span class="hs-identifier hs-type">Cavalry</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GameElements.html#Cavalry"><span class="hs-identifier hs-type">Cavalry</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GameElements.html#Cavalry"><span class="hs-identifier hs-type">Cavalry</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">6</span></span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><a href="Moves.html#getValue"><span class="hs-identifier hs-var">getValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameElements.html#Artillery"><span class="hs-identifier hs-type">Artillery</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GameElements.html#Artillery"><span class="hs-identifier hs-type">Artillery</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GameElements.html#Artillery"><span class="hs-identifier hs-type">Artillery</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">8</span></span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><a href="Moves.html#getValue"><span class="hs-identifier hs-var">getValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameElements.html#Wild"><span class="hs-identifier hs-type">Wild</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127741"><span class="annot"><span class="annottext">x :: Card
</span><a href="#local-6989586621679127741"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127740"><span class="annot"><span class="annottext">y :: Card
</span><a href="#local-6989586621679127740"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CardSet -&gt; p
</span><a href="Moves.html#getValue"><span class="hs-identifier hs-var">getValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Card
</span><a href="GameElements.html#Infantry"><span class="hs-identifier hs-var">Infantry</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127741"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127740"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>                          </span><span class="annot"><span class="annottext">p -&gt; p -&gt; p
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`max`</span></span><span> </span><span class="annot"><span class="annottext">CardSet -&gt; p
</span><a href="Moves.html#getValue"><span class="hs-identifier hs-var">getValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Card
</span><a href="GameElements.html#Cavalry"><span class="hs-identifier hs-var">Cavalry</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127741"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127740"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>                          </span><span class="annot"><span class="annottext">p -&gt; p -&gt; p
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`max`</span></span><span> </span><span class="annot"><span class="annottext">CardSet -&gt; p
</span><a href="Moves.html#getValue"><span class="hs-identifier hs-var">getValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Card
</span><a href="GameElements.html#Artillery"><span class="hs-identifier hs-var">Artillery</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127741"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127740"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><a href="Moves.html#getValue"><span class="hs-identifier hs-var">getValue</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127738"><span class="annot"><span class="annottext">x :: Card
</span><a href="#local-6989586621679127738"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GameElements.html#Wild"><span class="hs-identifier hs-type">Wild</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127737"><span class="annot"><span class="annottext">y :: Card
</span><a href="#local-6989586621679127737"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CardSet -&gt; p
</span><a href="Moves.html#getValue"><span class="hs-identifier hs-var">getValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Card
</span><a href="GameElements.html#Wild"><span class="hs-identifier hs-var">Wild</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127738"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127737"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><a href="Moves.html#getValue"><span class="hs-identifier hs-var">getValue</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127736"><span class="annot"><span class="annottext">x :: Card
</span><a href="#local-6989586621679127736"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127735"><span class="annot"><span class="annottext">y :: Card
</span><a href="#local-6989586621679127735"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GameElements.html#Wild"><span class="hs-identifier hs-type">Wild</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CardSet -&gt; p
</span><a href="Moves.html#getValue"><span class="hs-identifier hs-var">getValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Card
</span><a href="GameElements.html#Wild"><span class="hs-identifier hs-var">Wild</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127736"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127735"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><a href="Moves.html#getValue"><span class="hs-identifier hs-var">getValue</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127734"><span class="annot"><span class="annottext">x :: Card
</span><a href="#local-6989586621679127734"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127733"><span class="annot"><span class="annottext">y :: Card
</span><a href="#local-6989586621679127733"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127732"><span class="annot"><span class="annottext">z :: Card
</span><a href="#local-6989586621679127732"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127734"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Card -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127733"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127733"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Card -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127732"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127734"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Card -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127732"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>                         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-number">10</span></span><span>
</span><span id="line-57"></span><span>                         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><a href="Moves.html#territoryBonus"><span class="hs-identifier hs-type">territoryBonus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameElements.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-60"></span><span>  </span><span id="territoryBonus"><span class="annot"><span class="annottext">territoryBonus :: GameState -&gt; Player -&gt; Int
</span><a href="Moves.html#territoryBonus"><span class="hs-identifier hs-var hs-var">territoryBonus</span></a></span></span><span> </span><span id="local-6989586621679127729"><span class="annot"><span class="annottext">g :: GameState
</span><a href="#local-6989586621679127729"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679127728"><span class="annot"><span class="annottext">p :: Player
</span><a href="#local-6989586621679127728"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679127727"><span class="hs-identifier hs-var">territoriesOwned</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-number">3</span></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679127727"><span class="annot"><span class="annottext">territoriesOwned :: Int
</span><a href="#local-6989586621679127727"><span class="hs-identifier hs-var hs-var">territoriesOwned</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Country] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Country -&gt; Bool) -&gt; [Country] -&gt; [Country]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679127728"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Player -&gt; Bool) -&gt; (Country -&gt; Player) -&gt; Country -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Player
</span><a href="State.html#owner"><span class="hs-identifier hs-var">owner</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127729"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Country
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="RiskBoard.html#Country"><span class="hs-identifier hs-type">Country</span></a></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span>  </span><span class="annot"><a href="Moves.html#continentBonus"><span class="hs-identifier hs-type">continentBonus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameElements.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-64"></span><span>  </span><span id="continentBonus"><span class="annot"><span class="annottext">continentBonus :: GameState -&gt; Player -&gt; Int
</span><a href="Moves.html#continentBonus"><span class="hs-identifier hs-var hs-var">continentBonus</span></a></span></span><span> </span><span id="local-6989586621679127722"><span class="annot"><span class="annottext">g :: GameState
</span><a href="#local-6989586621679127722"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679127721"><span class="annot"><span class="annottext">p :: Player
</span><a href="#local-6989586621679127721"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Player -&gt; Int
</span><a href="Moves.html#australiaBonus"><span class="hs-identifier hs-var">australiaBonus</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127722"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679127721"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-65"></span><span>                     </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Player -&gt; Int
</span><a href="Moves.html#africaBonus"><span class="hs-identifier hs-var">africaBonus</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127722"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679127721"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-66"></span><span>                     </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Player -&gt; Int
</span><a href="Moves.html#southAmericaBonus"><span class="hs-identifier hs-var">southAmericaBonus</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127722"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679127721"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-67"></span><span>                     </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Player -&gt; Int
</span><a href="Moves.html#europeBonus"><span class="hs-identifier hs-var">europeBonus</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127722"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679127721"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-68"></span><span>                     </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Player -&gt; Int
</span><a href="Moves.html#asiaBonus"><span class="hs-identifier hs-var">asiaBonus</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127722"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679127721"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-69"></span><span>                     </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Player -&gt; Int
</span><a href="Moves.html#northAmericaBonus"><span class="hs-identifier hs-var">northAmericaBonus</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127722"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679127721"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span>  </span><span class="annot"><a href="Moves.html#australiaBonus"><span class="hs-identifier hs-type">australiaBonus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameElements.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-72"></span><span>  </span><span id="australiaBonus"><span class="annot"><span class="annottext">australiaBonus :: GameState -&gt; Player -&gt; Int
</span><a href="Moves.html#australiaBonus"><span class="hs-identifier hs-var hs-var">australiaBonus</span></a></span></span><span> </span><span id="local-6989586621679127714"><span class="annot"><span class="annottext">g :: GameState
</span><a href="#local-6989586621679127714"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679127713"><span class="annot"><span class="annottext">p :: Player
</span><a href="#local-6989586621679127713"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Country -&gt; Bool) -&gt; [Country] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679127713"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Player -&gt; Bool) -&gt; (Country -&gt; Player) -&gt; Country -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Player
</span><a href="State.html#owner"><span class="hs-identifier hs-var">owner</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127714"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Country]
</span><a href="RiskBoard.html#australia"><span class="hs-identifier hs-var">australia</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-73"></span><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-74"></span><span>  </span><span class="annot"><a href="Moves.html#africaBonus"><span class="hs-identifier hs-type">africaBonus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameElements.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-75"></span><span>  </span><span id="africaBonus"><span class="annot"><span class="annottext">africaBonus :: GameState -&gt; Player -&gt; Int
</span><a href="Moves.html#africaBonus"><span class="hs-identifier hs-var hs-var">africaBonus</span></a></span></span><span> </span><span id="local-6989586621679127710"><span class="annot"><span class="annottext">g :: GameState
</span><a href="#local-6989586621679127710"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679127709"><span class="annot"><span class="annottext">p :: Player
</span><a href="#local-6989586621679127709"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Country -&gt; Bool) -&gt; [Country] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679127709"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Player -&gt; Bool) -&gt; (Country -&gt; Player) -&gt; Country -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Player
</span><a href="State.html#owner"><span class="hs-identifier hs-var">owner</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127710"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Country]
</span><a href="RiskBoard.html#africa"><span class="hs-identifier hs-var">africa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">3</span></span><span>
</span><span id="line-76"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><a href="Moves.html#southAmericaBonus"><span class="hs-identifier hs-type">southAmericaBonus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameElements.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-79"></span><span>  </span><span id="southAmericaBonus"><span class="annot"><span class="annottext">southAmericaBonus :: GameState -&gt; Player -&gt; Int
</span><a href="Moves.html#southAmericaBonus"><span class="hs-identifier hs-var hs-var">southAmericaBonus</span></a></span></span><span> </span><span id="local-6989586621679127707"><span class="annot"><span class="annottext">g :: GameState
</span><a href="#local-6989586621679127707"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679127706"><span class="annot"><span class="annottext">p :: Player
</span><a href="#local-6989586621679127706"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Country -&gt; Bool) -&gt; [Country] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679127706"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Player -&gt; Bool) -&gt; (Country -&gt; Player) -&gt; Country -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Player
</span><a href="State.html#owner"><span class="hs-identifier hs-var">owner</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127707"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Country]
</span><a href="RiskBoard.html#southAmerica"><span class="hs-identifier hs-var">southAmerica</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-80"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span>  </span><span class="annot"><a href="Moves.html#asiaBonus"><span class="hs-identifier hs-type">asiaBonus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameElements.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-83"></span><span>  </span><span id="asiaBonus"><span class="annot"><span class="annottext">asiaBonus :: GameState -&gt; Player -&gt; Int
</span><a href="Moves.html#asiaBonus"><span class="hs-identifier hs-var hs-var">asiaBonus</span></a></span></span><span> </span><span id="local-6989586621679127704"><span class="annot"><span class="annottext">g :: GameState
</span><a href="#local-6989586621679127704"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679127703"><span class="annot"><span class="annottext">p :: Player
</span><a href="#local-6989586621679127703"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Country -&gt; Bool) -&gt; [Country] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679127703"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Player -&gt; Bool) -&gt; (Country -&gt; Player) -&gt; Country -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Player
</span><a href="State.html#owner"><span class="hs-identifier hs-var">owner</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127704"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Country]
</span><a href="RiskBoard.html#asia"><span class="hs-identifier hs-var">asia</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">7</span></span><span>
</span><span id="line-84"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span>  </span><span class="annot"><a href="Moves.html#europeBonus"><span class="hs-identifier hs-type">europeBonus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameElements.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-87"></span><span>  </span><span id="europeBonus"><span class="annot"><span class="annottext">europeBonus :: GameState -&gt; Player -&gt; Int
</span><a href="Moves.html#europeBonus"><span class="hs-identifier hs-var hs-var">europeBonus</span></a></span></span><span> </span><span id="local-6989586621679127701"><span class="annot"><span class="annottext">g :: GameState
</span><a href="#local-6989586621679127701"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679127700"><span class="annot"><span class="annottext">p :: Player
</span><a href="#local-6989586621679127700"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Country -&gt; Bool) -&gt; [Country] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679127700"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Player -&gt; Bool) -&gt; (Country -&gt; Player) -&gt; Country -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Player
</span><a href="State.html#owner"><span class="hs-identifier hs-var">owner</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127701"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Country]
</span><a href="RiskBoard.html#europe"><span class="hs-identifier hs-var">europe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">5</span></span><span>
</span><span id="line-88"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>  </span><span class="annot"><a href="Moves.html#northAmericaBonus"><span class="hs-identifier hs-type">northAmericaBonus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameElements.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-91"></span><span>  </span><span id="northAmericaBonus"><span class="annot"><span class="annottext">northAmericaBonus :: GameState -&gt; Player -&gt; Int
</span><a href="Moves.html#northAmericaBonus"><span class="hs-identifier hs-var hs-var">northAmericaBonus</span></a></span></span><span> </span><span id="local-6989586621679127698"><span class="annot"><span class="annottext">g :: GameState
</span><a href="#local-6989586621679127698"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679127697"><span class="annot"><span class="annottext">p :: Player
</span><a href="#local-6989586621679127697"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Country -&gt; Bool) -&gt; [Country] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679127697"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Player -&gt; Bool) -&gt; (Country -&gt; Player) -&gt; Country -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Player
</span><a href="State.html#owner"><span class="hs-identifier hs-var">owner</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127698"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Country]
</span><a href="RiskBoard.html#northAmerica"><span class="hs-identifier hs-var">northAmerica</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">5</span></span><span>
</span><span id="line-92"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-comment">-----------------------------------------------</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-comment">----Public Functions ---------------------</span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-comment">-- |Add reinforcements (specified as a list of pairs of 'Country' and non-negative 'Int' number of troops to add). Must be during the correct phase. Should update phase to 'Attack' 'Normal'. Continent and country bonuses should be taken into account.</span><span>
</span><span id="line-98"></span><span>  </span><span class="annot"><a href="Moves.html#reinforce"><span class="hs-identifier hs-type">reinforce</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameElements.html#TradeIn"><span class="hs-identifier hs-type">TradeIn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="RiskBoard.html#Country"><span class="hs-identifier hs-type">Country</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span id="reinforce"><span class="annot"><span class="annottext">reinforce :: TradeIn -&gt; [(Country, Int)] -&gt; GameState -&gt; Maybe GameState
</span><a href="Moves.html#reinforce"><span class="hs-identifier hs-var hs-var">reinforce</span></a></span></span><span> </span><span id="local-6989586621679127695"><span class="annot"><span class="annottext">trade :: TradeIn
</span><a href="#local-6989586621679127695"><span class="hs-identifier hs-var">trade</span></a></span></span><span> </span><span id="local-6989586621679127694"><span class="annot"><span class="annottext">movs :: [(Country, Int)]
</span><a href="#local-6989586621679127694"><span class="hs-identifier hs-var">movs</span></a></span></span><span> </span><span id="local-6989586621679127693"><span class="annot"><span class="annottext">gs :: GameState
</span><a href="#local-6989586621679127693"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TradeIn -&gt; Bool
</span><a href="#local-6989586621679127692"><span class="hs-identifier hs-var">validTrade</span></a></span><span> </span><span class="annot"><span class="annottext">TradeIn
</span><a href="#local-6989586621679127695"><span class="hs-identifier hs-var">trade</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Phase
</span><a href="State.html#phase"><span class="hs-identifier hs-var">phase</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127693"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Phase -&gt; Phase -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="State.html#Reinforce"><span class="hs-identifier hs-var">Reinforce</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[(Country, Int)] -&gt; Bool
</span><a href="#local-6989586621679127689"><span class="hs-identifier hs-var">validMovList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Country, Int)]
</span><a href="#local-6989586621679127694"><span class="hs-identifier hs-var">movs</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="annottext">GameState -&gt; Maybe GameState
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; Maybe GameState) -&gt; GameState -&gt; Maybe GameState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; GameState
</span><a href="State.html#nextPhase"><span class="hs-identifier hs-var">nextPhase</span></a></span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TradeIn -&gt; GameState -&gt; GameState
</span><a href="#local-6989586621679127687"><span class="hs-identifier hs-var">useCards</span></a></span><span> </span><span class="annot"><span class="annottext">TradeIn
</span><a href="#local-6989586621679127695"><span class="hs-identifier hs-var">trade</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Country, Int)
 -&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState)
-&gt; (GameState -&gt; GameState)
-&gt; [(Country, Int)]
-&gt; GameState
-&gt; GameState
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(GameState -&gt; GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span class="annot"><span class="annottext">((GameState -&gt; GameState)
 -&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState)
-&gt; ((Country, Int) -&gt; GameState -&gt; GameState)
-&gt; (Country, Int)
-&gt; (GameState -&gt; GameState)
-&gt; GameState
-&gt; GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Country -&gt; Int -&gt; GameState -&gt; GameState)
-&gt; (Country, Int) -&gt; GameState -&gt; GameState
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Country -&gt; Int -&gt; GameState -&gt; GameState
</span><a href="State.html#changeTroops"><span class="hs-identifier hs-var">changeTroops</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; GameState
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">[(Country, Int)]
</span><a href="#local-6989586621679127694"><span class="hs-identifier hs-var">movs</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127693"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-101"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GameState
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679127689"><span class="annot"><span class="annottext">validMovList :: [(Country, Int)] -&gt; Bool
</span><a href="#local-6989586621679127689"><span class="hs-identifier hs-var hs-var">validMovList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(Country, Int)] -&gt; Bool
forall t. (Num t, Ord t) =&gt; t -&gt; [(Country, t)] -&gt; Bool
</span><a href="#local-6989586621679127682"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; TradeIn -&gt; Player -&gt; Int
</span><a href="Moves.html#nReinforcements"><span class="hs-identifier hs-var">nReinforcements</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127693"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">TradeIn
</span><a href="#local-6989586621679127695"><span class="hs-identifier hs-var">trade</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Player
</span><a href="Moves.html#currPlayer"><span class="hs-identifier hs-var">currPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127693"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>          </span><span id="local-6989586621679127682"><span class="annot"><span class="annottext">valid :: t -&gt; [(Country, t)] -&gt; Bool
</span><a href="#local-6989586621679127682"><span class="hs-identifier hs-var hs-var">valid</span></a></span></span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-104"></span><span>          </span><span class="annot"><a href="#local-6989586621679127682"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-105"></span><span>          </span><span class="annot"><a href="#local-6989586621679127682"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span id="local-6989586621679127681"><span class="annot"><span class="annottext">n :: t
</span><a href="#local-6989586621679127681"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679127680"><span class="annot"><span class="annottext">c :: Country
</span><a href="#local-6989586621679127680"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127679"><span class="annot"><span class="annottext">t :: t
</span><a href="#local-6989586621679127679"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679127678"><span class="annot"><span class="annottext">ms :: [(Country, t)]
</span><a href="#local-6989586621679127678"><span class="hs-identifier hs-var">ms</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Player
</span><a href="State.html#owner"><span class="hs-identifier hs-var">owner</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127693"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127680"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Player
</span><a href="Moves.html#currPlayer"><span class="hs-identifier hs-var">currPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127693"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>                                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679127679"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>                                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; [(Country, t)] -&gt; Bool
</span><a href="#local-6989586621679127682"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679127681"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679127679"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Country, t)]
</span><a href="#local-6989586621679127678"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-108"></span><span>          </span><span id="local-6989586621679127692"><span class="annot"><span class="annottext">validTrade :: TradeIn -&gt; Bool
</span><a href="#local-6989586621679127692"><span class="hs-identifier hs-var hs-var">validTrade</span></a></span></span><span> </span><span class="annot"><a href="GameElements.html#None"><span class="hs-identifier hs-type">None</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-109"></span><span>          </span><span class="annot"><a href="#local-6989586621679127692"><span class="hs-identifier hs-var">validTrade</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameElements.html#OneSet"><span class="hs-identifier hs-type">OneSet</span></a></span><span> </span><span id="local-6989586621679127676"><span class="annot"><span class="annottext">s :: CardSet
</span><a href="#local-6989586621679127676"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CardSet -&gt; Bool
</span><a href="#local-6989586621679127675"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">CardSet
</span><a href="#local-6989586621679127676"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-110"></span><span>          </span><span class="annot"><a href="#local-6989586621679127692"><span class="hs-identifier hs-var">validTrade</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameElements.html#TwoSet"><span class="hs-identifier hs-type">TwoSet</span></a></span><span> </span><span id="local-6989586621679127674"><span class="annot"><span class="annottext">s1 :: CardSet
</span><a href="#local-6989586621679127674"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621679127673"><span class="annot"><span class="annottext">s2 :: CardSet
</span><a href="#local-6989586621679127673"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CardSet -&gt; Bool
</span><a href="#local-6989586621679127675"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">CardSet
</span><a href="#local-6989586621679127674"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">CardSet -&gt; Bool
</span><a href="#local-6989586621679127675"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">CardSet
</span><a href="#local-6989586621679127673"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-111"></span><span>          </span><span id="local-6989586621679127675"><span class="annot"><span class="annottext">t :: CardSet -&gt; Bool
</span><a href="#local-6989586621679127675"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameElements.html#Wild"><span class="hs-identifier hs-type">Wild</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-112"></span><span>          </span><span class="annot"><a href="#local-6989586621679127675"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GameElements.html#Wild"><span class="hs-identifier hs-type">Wild</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-113"></span><span>          </span><span class="annot"><a href="#local-6989586621679127675"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GameElements.html#Wild"><span class="hs-identifier hs-type">Wild</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-114"></span><span>          </span><span class="annot"><a href="#local-6989586621679127675"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127672"><span class="annot"><span class="annottext">x :: Card
</span><a href="#local-6989586621679127672"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127671"><span class="annot"><span class="annottext">y :: Card
</span><a href="#local-6989586621679127671"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127670"><span class="annot"><span class="annottext">z :: Card
</span><a href="#local-6989586621679127670"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127672"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Card -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127671"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127671"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Card -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127670"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127672"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Card -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127671"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127672"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Card -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127670"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127671"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Card -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127670"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>          </span><span id="local-6989586621679127687"><span class="annot"><span class="annottext">useCards :: TradeIn -&gt; GameState -&gt; GameState
</span><a href="#local-6989586621679127687"><span class="hs-identifier hs-var hs-var">useCards</span></a></span></span><span> </span><span class="annot"><a href="GameElements.html#None"><span class="hs-identifier hs-type">None</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; GameState
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-116"></span><span>          </span><span class="annot"><a href="#local-6989586621679127687"><span class="hs-identifier hs-var">useCards</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameElements.html#OneSet"><span class="hs-identifier hs-type">OneSet</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127668"><span class="annot"><span class="annottext">x :: Card
</span><a href="#local-6989586621679127668"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127667"><span class="annot"><span class="annottext">y :: Card
</span><a href="#local-6989586621679127667"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127666"><span class="annot"><span class="annottext">z :: Card
</span><a href="#local-6989586621679127666"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player -&gt; Card -&gt; GameState -&gt; GameState
</span><a href="State.html#useCard"><span class="hs-identifier hs-var">useCard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Player
</span><a href="Moves.html#currPlayer"><span class="hs-identifier hs-var">currPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127693"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127668"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player -&gt; Card -&gt; GameState -&gt; GameState
</span><a href="State.html#useCard"><span class="hs-identifier hs-var">useCard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Player
</span><a href="Moves.html#currPlayer"><span class="hs-identifier hs-var">currPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127693"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127667"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player -&gt; Card -&gt; GameState -&gt; GameState
</span><a href="State.html#useCard"><span class="hs-identifier hs-var">useCard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Player
</span><a href="Moves.html#currPlayer"><span class="hs-identifier hs-var">currPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127693"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127666"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>          </span><span class="annot"><a href="#local-6989586621679127687"><span class="hs-identifier hs-var">useCards</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameElements.html#TwoSet"><span class="hs-identifier hs-type">TwoSet</span></a></span><span> </span><span id="local-6989586621679127664"><span class="annot"><span class="annottext">s1 :: CardSet
</span><a href="#local-6989586621679127664"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621679127663"><span class="annot"><span class="annottext">s2 :: CardSet
</span><a href="#local-6989586621679127663"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TradeIn -&gt; GameState -&gt; GameState
</span><a href="#local-6989586621679127687"><span class="hs-identifier hs-var">useCards</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardSet -&gt; TradeIn
</span><a href="GameElements.html#OneSet"><span class="hs-identifier hs-var">OneSet</span></a></span><span> </span><span class="annot"><span class="annottext">CardSet
</span><a href="#local-6989586621679127664"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TradeIn -&gt; GameState -&gt; GameState
</span><a href="#local-6989586621679127687"><span class="hs-identifier hs-var">useCards</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardSet -&gt; TradeIn
</span><a href="GameElements.html#OneSet"><span class="hs-identifier hs-var">OneSet</span></a></span><span> </span><span class="annot"><span class="annottext">CardSet
</span><a href="#local-6989586621679127663"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>          </span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-comment">-- |Puts the state into the 'MidBattle' 'MiniPhase', which records the attacking and defending country, and the number of attackers. Must Be neighbouring countries owned by different players. Must be during the correct phase. Attacker must have &lt; number of attackers in the attacking country.</span><span>
</span><span id="line-120"></span><span>  </span><span class="annot"><a href="Moves.html#attack"><span class="hs-identifier hs-type">attack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="RiskBoard.html#Country"><span class="hs-identifier hs-type">Country</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="RiskBoard.html#Country"><span class="hs-identifier hs-type">Country</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Battle.html#Attackers"><span class="hs-identifier hs-type">Attackers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span id="attack"><span class="annot"><span class="annottext">attack :: Country -&gt; Country -&gt; Attackers -&gt; GameState -&gt; Maybe GameState
</span><a href="Moves.html#attack"><span class="hs-identifier hs-var hs-var">attack</span></a></span></span><span> </span><span id="local-6989586621679127662"><span class="annot"><span class="annottext">cAtt :: Country
</span><a href="#local-6989586621679127662"><span class="hs-identifier hs-var">cAtt</span></a></span></span><span> </span><span id="local-6989586621679127661"><span class="annot"><span class="annottext">cDef :: Country
</span><a href="#local-6989586621679127661"><span class="hs-identifier hs-var">cDef</span></a></span></span><span> </span><span id="local-6989586621679127660"><span class="annot"><span class="annottext">att :: Attackers
</span><a href="#local-6989586621679127660"><span class="hs-identifier hs-var">att</span></a></span></span><span> </span><span id="local-6989586621679127659"><span class="annot"><span class="annottext">gs :: GameState
</span><a href="#local-6989586621679127659"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679127658"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Maybe GameState
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; Maybe GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; Maybe GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MiniPhase -&gt; GameState -&gt; GameState
</span><a href="State.html#changeMiniPhase"><span class="hs-identifier hs-var">changeMiniPhase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Country -&gt; Country -&gt; Attackers -&gt; MiniPhase
</span><a href="State.html#MidBattle"><span class="hs-identifier hs-var">MidBattle</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127662"><span class="hs-identifier hs-var">cAtt</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127661"><span class="hs-identifier hs-var">cDef</span></a></span><span> </span><span class="annot"><span class="annottext">Attackers
</span><a href="#local-6989586621679127660"><span class="hs-identifier hs-var">att</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127659"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-122"></span><span>                          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GameState
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>      </span><span id="local-6989586621679127658"><span class="annot"><span class="annottext">valid :: Bool
</span><a href="#local-6989586621679127658"><span class="hs-identifier hs-var hs-var">valid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Int
</span><a href="State.html#troops"><span class="hs-identifier hs-var">troops</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127659"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127662"><span class="hs-identifier hs-var">cAtt</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Attackers -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Attackers
</span><a href="#local-6989586621679127660"><span class="hs-identifier hs-var">att</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-125"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Player
</span><a href="State.html#owner"><span class="hs-identifier hs-var">owner</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127659"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127662"><span class="hs-identifier hs-var">cAtt</span></a></span><span> </span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Player
</span><a href="Moves.html#currPlayer"><span class="hs-identifier hs-var">currPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127659"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-126"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Player
</span><a href="State.html#owner"><span class="hs-identifier hs-var">owner</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127659"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127661"><span class="hs-identifier hs-var">cDef</span></a></span><span> </span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Player
</span><a href="Moves.html#currPlayer"><span class="hs-identifier hs-var">currPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127659"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-127"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127661"><span class="hs-identifier hs-var">cDef</span></a></span><span> </span><span class="annot"><span class="annottext">Country -&gt; Country -&gt; Bool
</span><a href="RiskBoard.html#isNeighbour"><span class="hs-operator hs-var">`isNeighbour`</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127662"><span class="hs-identifier hs-var">cAtt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-128"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Phase
</span><a href="State.html#phase"><span class="hs-identifier hs-var">phase</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127659"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Phase -&gt; Phase -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">MiniPhase -&gt; Phase
</span><a href="State.html#Attack"><span class="hs-identifier hs-var">Attack</span></a></span><span> </span><span class="annot"><span class="annottext">MiniPhase
</span><a href="State.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>  </span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-comment">--TODO make sure it goes back to Attack Normal if the battle isn't won.</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-comment">-- |Only defined for 'MidBattle' 'MiniPhase'. Chooses the number of defenders the defending country uses. The defending country must have &gt;= number of defenders used. Enters 'WonBattle' phase if there are no defenders left, otherwise goes back to 'Attack' 'Normal' 'MiniPhase'.</span><span>
</span><span id="line-132"></span><span>  </span><span class="annot"><a href="Moves.html#chooseDefenders"><span class="hs-identifier hs-type">chooseDefenders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Battle.html#Defenders"><span class="hs-identifier hs-type">Defenders</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span>
</span><span id="line-133"></span><span>  </span><span id="chooseDefenders"><span class="annot"><span class="annottext">chooseDefenders :: Defenders -&gt; GameState -&gt; Maybe GameState
</span><a href="Moves.html#chooseDefenders"><span class="hs-identifier hs-var hs-var">chooseDefenders</span></a></span></span><span> </span><span id="local-6989586621679127650"><span class="annot"><span class="annottext">def :: Defenders
</span><a href="#local-6989586621679127650"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621679127649"><span class="annot"><span class="annottext">gs :: GameState
</span><a href="#local-6989586621679127649"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Phase -&gt; Maybe GameState
</span><a href="#local-6989586621679127648"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Phase
</span><a href="State.html#phase"><span class="hs-identifier hs-var">phase</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127649"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679127648"><span class="annot"><span class="annottext">f :: Phase -&gt; Maybe GameState
</span><a href="#local-6989586621679127648"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="State.html#Attack"><span class="hs-identifier hs-type">Attack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="State.html#MidBattle"><span class="hs-identifier hs-type">MidBattle</span></a></span><span> </span><span id="local-6989586621679127647"><span class="annot"><span class="annottext">cAtt :: Country
</span><a href="#local-6989586621679127647"><span class="hs-identifier hs-var">cAtt</span></a></span></span><span> </span><span id="local-6989586621679127646"><span class="annot"><span class="annottext">cDef :: Country
</span><a href="#local-6989586621679127646"><span class="hs-identifier hs-var">cDef</span></a></span></span><span> </span><span id="local-6989586621679127645"><span class="annot"><span class="annottext">att :: Attackers
</span><a href="#local-6989586621679127645"><span class="hs-identifier hs-var">att</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Int
</span><a href="State.html#troops"><span class="hs-identifier hs-var">troops</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127649"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127646"><span class="hs-identifier hs-var">cDef</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Defenders -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Defenders
</span><a href="#local-6989586621679127650"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Maybe GameState
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; Maybe GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; Maybe GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int, StdGen) -&gt; GameState -&gt; GameState
</span><a href="#local-6989586621679127644"><span class="hs-identifier hs-var">makeChange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attackers -&gt; Defenders -&gt; StdGen -&gt; (Int, Int, StdGen)
</span><a href="Battle.html#doBattle"><span class="hs-identifier hs-var">doBattle</span></a></span><span> </span><span class="annot"><span class="annottext">Attackers
</span><a href="#local-6989586621679127645"><span class="hs-identifier hs-var">att</span></a></span><span> </span><span class="annot"><span class="annottext">Defenders
</span><a href="#local-6989586621679127650"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">(StdGen -&gt; (Int, Int, StdGen)) -&gt; StdGen -&gt; (Int, Int, StdGen)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; StdGen
</span><a href="State.html#currentStdGen"><span class="hs-identifier hs-var">currentStdGen</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127649"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127649"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-135"></span><span>                                               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GameState
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-136"></span><span>            </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679127644"><span class="annot"><span class="annottext">makeChange :: (Int, Int, StdGen) -&gt; GameState -&gt; GameState
</span><a href="#local-6989586621679127644"><span class="hs-identifier hs-var hs-var">makeChange</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127641"><span class="annot"><span class="annottext">attLosses :: Int
</span><a href="#local-6989586621679127641"><span class="hs-identifier hs-var">attLosses</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127640"><span class="annot"><span class="annottext">defLosses :: Int
</span><a href="#local-6989586621679127640"><span class="hs-identifier hs-var">defLosses</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127639"><span class="annot"><span class="annottext">stdGen :: StdGen
</span><a href="#local-6989586621679127639"><span class="hs-identifier hs-var">stdGen</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-137"></span><span>                    </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679127640"><span class="hs-identifier hs-var">defLosses</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Int
</span><a href="State.html#troops"><span class="hs-identifier hs-var">troops</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127649"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127646"><span class="hs-identifier hs-var">cDef</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">--attacker has won a country</span><span>
</span><span id="line-138"></span><span>                      </span><span class="hs-keyword">then</span><span>
</span><span id="line-139"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MiniPhase -&gt; GameState -&gt; GameState
</span><a href="State.html#changeMiniPhase"><span class="hs-identifier hs-var">changeMiniPhase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Country -&gt; Country -&gt; Attackers -&gt; MiniPhase
</span><a href="State.html#WonBattle"><span class="hs-identifier hs-var">WonBattle</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127647"><span class="hs-identifier hs-var">cAtt</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127646"><span class="hs-identifier hs-var">cDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Attackers
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679127637"><span class="hs-identifier hs-var">nInvaders</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; GameState
</span><a href="#local-6989586621679127636"><span class="hs-identifier hs-var">regularChanges</span></a></span><span>
</span><span id="line-140"></span><span>                      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; GameState
</span><a href="#local-6989586621679127636"><span class="hs-identifier hs-var">regularChanges</span></a></span><span>
</span><span id="line-141"></span><span>                    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679127636"><span class="annot"><span class="annottext">regularChanges :: GameState -&gt; GameState
</span><a href="#local-6989586621679127636"><span class="hs-identifier hs-var hs-var">regularChanges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Country -&gt; Int -&gt; GameState -&gt; GameState
</span><a href="State.html#changeTroops"><span class="hs-identifier hs-var">changeTroops</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127647"><span class="hs-identifier hs-var">cAtt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679127641"><span class="hs-identifier hs-var">attLosses</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Country -&gt; Int -&gt; GameState -&gt; GameState
</span><a href="State.html#changeTroops"><span class="hs-identifier hs-var">changeTroops</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127646"><span class="hs-identifier hs-var">cDef</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679127640"><span class="hs-identifier hs-var">defLosses</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StdGen -&gt; GameState -&gt; GameState
</span><a href="State.html#updateStdGen"><span class="hs-identifier hs-var">updateStdGen</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679127639"><span class="hs-identifier hs-var">stdGen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>                          </span><span id="local-6989586621679127637"><span class="annot"><span class="annottext">nInvaders :: Int
</span><a href="#local-6989586621679127637"><span class="hs-identifier hs-var hs-var">nInvaders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attackers -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Attackers
</span><a href="#local-6989586621679127645"><span class="hs-identifier hs-var">att</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679127641"><span class="hs-identifier hs-var">attLosses</span></a></span><span>
</span><span id="line-143"></span><span>          </span><span class="annot"><a href="#local-6989586621679127648"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GameState
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-comment">-- |Invades a country from another with 'Int' number of troops, meaning owner is changed and 'Int' troops are tranferred from the attacking country to the defending country. Should be only able to be called in 'WonBattle' 'MiniPhase'. Can't invade with less than the number of attackers left. Should move back to a 'Normal' 'Attack' 'MiniPhase'. Gives an error if called with a 'MiniPhase' which shouldn't be possible. Kicks players out if their last country is invaded. Also calculates when winning.</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-comment">-- It must invade with at least the number of attackers left, must leave at least 1 in the previous country.</span><span>
</span><span id="line-147"></span><span>  </span><span class="annot"><a href="Moves.html#invade"><span class="hs-identifier hs-type">invade</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span id="invade"><span class="annot"><span class="annottext">invade :: Int -&gt; GameState -&gt; Maybe GameState
</span><a href="Moves.html#invade"><span class="hs-identifier hs-var hs-var">invade</span></a></span></span><span> </span><span id="local-6989586621679127634"><span class="annot"><span class="annottext">nTroops :: Int
</span><a href="#local-6989586621679127634"><span class="hs-identifier hs-var">nTroops</span></a></span></span><span> </span><span id="local-6989586621679127633"><span class="annot"><span class="annottext">gs :: GameState
</span><a href="#local-6989586621679127633"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Phase -&gt; Maybe GameState
</span><a href="#local-6989586621679127632"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Phase
</span><a href="State.html#phase"><span class="hs-identifier hs-var">phase</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127633"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-150"></span><span>      </span><span id="local-6989586621679127632"><span class="annot"><span class="annottext">f :: Phase -&gt; Maybe GameState
</span><a href="#local-6989586621679127632"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="State.html#Attack"><span class="hs-identifier hs-type">Attack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="State.html#WonBattle"><span class="hs-identifier hs-type">WonBattle</span></a></span><span> </span><span id="local-6989586621679127631"><span class="annot"><span class="annottext">cAtt :: Country
</span><a href="#local-6989586621679127631"><span class="hs-identifier hs-var">cAtt</span></a></span></span><span> </span><span id="local-6989586621679127630"><span class="annot"><span class="annottext">cDef :: Country
</span><a href="#local-6989586621679127630"><span class="hs-identifier hs-var">cDef</span></a></span></span><span> </span><span id="local-6989586621679127629"><span class="annot"><span class="annottext">attLeft :: Attackers
</span><a href="#local-6989586621679127629"><span class="hs-identifier hs-var">attLeft</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127631"><span class="hs-identifier hs-var">cAtt</span></a></span><span> </span><span class="annot"><span class="annottext">Country -&gt; Country -&gt; Bool
</span><a href="RiskBoard.html#isNeighbour"><span class="hs-operator hs-var">`isNeighbour`</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127630"><span class="hs-identifier hs-var">cDef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Player
</span><a href="State.html#owner"><span class="hs-identifier hs-var">owner</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127633"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127631"><span class="hs-identifier hs-var">cAtt</span></a></span><span> </span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Player
</span><a href="State.html#owner"><span class="hs-identifier hs-var">owner</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127633"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127630"><span class="hs-identifier hs-var">cDef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Player
</span><a href="State.html#owner"><span class="hs-identifier hs-var">owner</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127633"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127631"><span class="hs-identifier hs-var">cAtt</span></a></span><span> </span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Player
</span><a href="Moves.html#currPlayer"><span class="hs-identifier hs-var">currPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127633"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Maybe GameState
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Impossible MiniPhase&quot;</span></span><span>
</span><span id="line-152"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679127634"><span class="hs-identifier hs-var">nTroops</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Attackers -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Attackers
</span><a href="#local-6989586621679127629"><span class="hs-identifier hs-var">attLeft</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679127634"><span class="hs-identifier hs-var">nTroops</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Int
</span><a href="State.html#troops"><span class="hs-identifier hs-var">troops</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127633"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127631"><span class="hs-identifier hs-var">cAtt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-153"></span><span>          </span><span class="annot"><span class="annottext">GameState -&gt; Maybe GameState
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; Maybe GameState) -&gt; GameState -&gt; Maybe GameState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">MiniPhase -&gt; GameState -&gt; GameState
</span><a href="State.html#changeMiniPhase"><span class="hs-identifier hs-var">changeMiniPhase</span></a></span><span> </span><span class="annot"><span class="annottext">MiniPhase
</span><a href="State.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">GameState -&gt; GameState
</span><a href="#local-6989586621679127625"><span class="hs-identifier hs-var">forceDiscard</span></a></span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; GameState -&gt; GameState
</span><a href="#local-6989586621679127624"><span class="hs-identifier hs-var">tryKick</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Player
</span><a href="State.html#owner"><span class="hs-identifier hs-var">owner</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127633"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127631"><span class="hs-identifier hs-var">cAtt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Player
</span><a href="State.html#owner"><span class="hs-identifier hs-var">owner</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127633"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127630"><span class="hs-identifier hs-var">cDef</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player -&gt; GameState -&gt; GameState
</span><a href="State.html#drawCard"><span class="hs-identifier hs-var">drawCard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Player
</span><a href="Moves.html#currPlayer"><span class="hs-identifier hs-var">currPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127633"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Country -&gt; Player -&gt; GameState -&gt; GameState
</span><a href="State.html#changeOwner"><span class="hs-identifier hs-var">changeOwner</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127630"><span class="hs-identifier hs-var">cDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Player
</span><a href="Moves.html#currPlayer"><span class="hs-identifier hs-var">currPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127633"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="annottext">(GameState -&gt; GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Country -&gt; Int -&gt; GameState -&gt; GameState
</span><a href="State.html#changeTroops"><span class="hs-identifier hs-var">changeTroops</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127631"><span class="hs-identifier hs-var">cAtt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679127634"><span class="hs-identifier hs-var">nTroops</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Country -&gt; Int -&gt; GameState -&gt; GameState
</span><a href="State.html#changeTroops"><span class="hs-identifier hs-var">changeTroops</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127630"><span class="hs-identifier hs-var">cDef</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679127634"><span class="hs-identifier hs-var">nTroops</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127633"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-154"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GameState
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-155"></span><span>        </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679127625"><span class="annot"><span class="annottext">forceDiscard :: GameState -&gt; GameState
</span><a href="#local-6989586621679127625"><span class="hs-identifier hs-var hs-var">forceDiscard</span></a></span></span><span> </span><span id="local-6989586621679127621"><span class="annot"><span class="annottext">gs' :: GameState
</span><a href="#local-6989586621679127621"><span class="hs-identifier hs-var">gs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Card] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Player -&gt; [Card]
</span><a href="State.html#cards"><span class="hs-identifier hs-var">cards</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127621"><span class="hs-identifier hs-var">gs'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Player
</span><a href="Moves.html#currPlayer"><span class="hs-identifier hs-var">currPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127621"><span class="hs-identifier hs-var">gs'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="hs-number">6</span></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>                                   </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">MiniPhase -&gt; GameState -&gt; GameState
</span><a href="State.html#changeMiniPhase"><span class="hs-identifier hs-var">changeMiniPhase</span></a></span><span> </span><span class="annot"><span class="annottext">MiniPhase
</span><a href="State.html#TimeToTrade"><span class="hs-identifier hs-var">TimeToTrade</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127621"><span class="hs-identifier hs-var">gs'</span></a></span><span>
</span><span id="line-157"></span><span>                                   </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127621"><span class="hs-identifier hs-var">gs'</span></a></span><span>
</span><span id="line-158"></span><span>      </span><span class="annot"><a href="#local-6989586621679127632"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GameState
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-159"></span><span>      </span><span class="annot"><a href="#local-6989586621679127624"><span class="hs-identifier hs-type">tryKick</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameElements.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameElements.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span>
</span><span id="line-160"></span><span>      </span><span id="local-6989586621679127624"><span class="annot"><span class="annottext">tryKick :: Player -&gt; Player -&gt; GameState -&gt; GameState
</span><a href="#local-6989586621679127624"><span class="hs-identifier hs-var hs-var">tryKick</span></a></span></span><span> </span><span id="local-6989586621679127618"><span class="annot"><span class="annottext">pAtt :: Player
</span><a href="#local-6989586621679127618"><span class="hs-identifier hs-var">pAtt</span></a></span></span><span> </span><span id="local-6989586621679127617"><span class="annot"><span class="annottext">pDef :: Player
</span><a href="#local-6989586621679127617"><span class="hs-identifier hs-var">pDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(Country -&gt; Bool) -&gt; [Country] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679127617"><span class="hs-identifier hs-var">pDef</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Player -&gt; Bool) -&gt; (Country -&gt; Player) -&gt; Country -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Player
</span><a href="State.html#owner"><span class="hs-identifier hs-var">owner</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127633"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Country
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="RiskBoard.html#Country"><span class="hs-identifier hs-type">Country</span></a></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-161"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; GameState -&gt; GameState
</span><a href="State.html#kick"><span class="hs-identifier hs-var">kick</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679127618"><span class="hs-identifier hs-var">pAtt</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679127617"><span class="hs-identifier hs-var">pDef</span></a></span><span>
</span><span id="line-162"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; GameState
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-163"></span><span>                        </span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-comment">-- |Only valid during the 'Attack' 'TimeToTrade' 'MiniPhase'. Takes a 'TradeIn' (owned by the current player) and caches it in for troops.</span><span>
</span><span id="line-165"></span><span>  </span><span class="annot"><a href="Moves.html#trade"><span class="hs-identifier hs-type">trade</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameElements.html#TradeIn"><span class="hs-identifier hs-type">TradeIn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="RiskBoard.html#Country"><span class="hs-identifier hs-type">Country</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span>
</span><span id="line-166"></span><span>  </span><span id="trade"><span class="annot"><span class="annottext">trade :: TradeIn -&gt; [(Country, Int)] -&gt; GameState -&gt; Maybe GameState
</span><a href="Moves.html#trade"><span class="hs-identifier hs-var hs-var">trade</span></a></span></span><span> </span><span id="local-6989586621679127614"><span class="annot"><span class="annottext">tr :: TradeIn
</span><a href="#local-6989586621679127614"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679127613"><span class="annot"><span class="annottext">movs :: [(Country, Int)]
</span><a href="#local-6989586621679127613"><span class="hs-identifier hs-var">movs</span></a></span></span><span> </span><span id="local-6989586621679127612"><span class="annot"><span class="annottext">gs :: GameState
</span><a href="#local-6989586621679127612"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TradeIn -&gt; Bool
</span><a href="#local-6989586621679127611"><span class="hs-identifier hs-var">validTrade</span></a></span><span> </span><span class="annot"><span class="annottext">TradeIn
</span><a href="#local-6989586621679127614"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Phase
</span><a href="State.html#phase"><span class="hs-identifier hs-var">phase</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127612"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Phase -&gt; Phase -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">MiniPhase -&gt; Phase
</span><a href="State.html#Attack"><span class="hs-identifier hs-var">Attack</span></a></span><span> </span><span class="annot"><span class="annottext">MiniPhase
</span><a href="State.html#TimeToTrade"><span class="hs-identifier hs-var">TimeToTrade</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[(Country, Int)] -&gt; Bool
</span><a href="#local-6989586621679127610"><span class="hs-identifier hs-var">validMovList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Country, Int)]
</span><a href="#local-6989586621679127613"><span class="hs-identifier hs-var">movs</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="annottext">GameState -&gt; Maybe GameState
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; Maybe GameState) -&gt; GameState -&gt; Maybe GameState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; GameState
</span><a href="State.html#nextPhase"><span class="hs-identifier hs-var">nextPhase</span></a></span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TradeIn -&gt; GameState -&gt; GameState
</span><a href="#local-6989586621679127609"><span class="hs-identifier hs-var">useCards</span></a></span><span> </span><span class="annot"><span class="annottext">TradeIn
</span><a href="#local-6989586621679127614"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Country, Int)
 -&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState)
-&gt; (GameState -&gt; GameState)
-&gt; [(Country, Int)]
-&gt; GameState
-&gt; GameState
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(GameState -&gt; GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span class="annot"><span class="annottext">((GameState -&gt; GameState)
 -&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState)
-&gt; ((Country, Int) -&gt; GameState -&gt; GameState)
-&gt; (Country, Int)
-&gt; (GameState -&gt; GameState)
-&gt; GameState
-&gt; GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Country -&gt; Int -&gt; GameState -&gt; GameState)
-&gt; (Country, Int) -&gt; GameState -&gt; GameState
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Country -&gt; Int -&gt; GameState -&gt; GameState
</span><a href="State.html#changeTroops"><span class="hs-identifier hs-var">changeTroops</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; GameState
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">[(Country, Int)]
</span><a href="#local-6989586621679127613"><span class="hs-identifier hs-var">movs</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127612"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-168"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GameState
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679127610"><span class="annot"><span class="annottext">validMovList :: [(Country, Int)] -&gt; Bool
</span><a href="#local-6989586621679127610"><span class="hs-identifier hs-var hs-var">validMovList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(Country, Int)] -&gt; Bool
forall t. (Num t, Ord t) =&gt; t -&gt; [(Country, t)] -&gt; Bool
</span><a href="#local-6989586621679127608"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TradeIn -&gt; Int
</span><a href="Moves.html#tradeInBonus"><span class="hs-identifier hs-var">tradeInBonus</span></a></span><span> </span><span class="annot"><span class="annottext">TradeIn
</span><a href="#local-6989586621679127614"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>          </span><span id="local-6989586621679127608"><span class="annot"><span class="annottext">valid :: t -&gt; [(Country, t)] -&gt; Bool
</span><a href="#local-6989586621679127608"><span class="hs-identifier hs-var hs-var">valid</span></a></span></span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-171"></span><span>          </span><span class="annot"><a href="#local-6989586621679127608"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-172"></span><span>          </span><span class="annot"><a href="#local-6989586621679127608"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span id="local-6989586621679127607"><span class="annot"><span class="annottext">n :: t
</span><a href="#local-6989586621679127607"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679127606"><span class="annot"><span class="annottext">c :: Country
</span><a href="#local-6989586621679127606"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679127605"><span class="annot"><span class="annottext">t :: t
</span><a href="#local-6989586621679127605"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679127604"><span class="annot"><span class="annottext">ms :: [(Country, t)]
</span><a href="#local-6989586621679127604"><span class="hs-identifier hs-var">ms</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Player
</span><a href="State.html#owner"><span class="hs-identifier hs-var">owner</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127612"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127606"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Player
</span><a href="Moves.html#currPlayer"><span class="hs-identifier hs-var">currPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127612"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>                                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679127605"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>                                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; [(Country, t)] -&gt; Bool
</span><a href="#local-6989586621679127608"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679127607"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679127605"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Country, t)]
</span><a href="#local-6989586621679127604"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-175"></span><span>          </span><span id="local-6989586621679127611"><span class="annot"><span class="annottext">validTrade :: TradeIn -&gt; Bool
</span><a href="#local-6989586621679127611"><span class="hs-identifier hs-var hs-var">validTrade</span></a></span></span><span> </span><span class="annot"><a href="GameElements.html#None"><span class="hs-identifier hs-type">None</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-176"></span><span>          </span><span class="annot"><a href="#local-6989586621679127611"><span class="hs-identifier hs-var">validTrade</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameElements.html#OneSet"><span class="hs-identifier hs-type">OneSet</span></a></span><span> </span><span id="local-6989586621679127603"><span class="annot"><span class="annottext">s :: CardSet
</span><a href="#local-6989586621679127603"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CardSet -&gt; Bool
</span><a href="#local-6989586621679127602"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">CardSet
</span><a href="#local-6989586621679127603"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[Card] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Player -&gt; [Card]
</span><a href="State.html#cards"><span class="hs-identifier hs-var">cards</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127612"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Player
</span><a href="Moves.html#currPlayer"><span class="hs-identifier hs-var">currPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127612"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="hs-number">5</span></span><span>
</span><span id="line-177"></span><span>          </span><span class="annot"><a href="#local-6989586621679127611"><span class="hs-identifier hs-var">validTrade</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameElements.html#TwoSet"><span class="hs-identifier hs-type">TwoSet</span></a></span><span> </span><span id="local-6989586621679127601"><span class="annot"><span class="annottext">s1 :: CardSet
</span><a href="#local-6989586621679127601"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621679127600"><span class="annot"><span class="annottext">s2 :: CardSet
</span><a href="#local-6989586621679127600"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CardSet -&gt; Bool
</span><a href="#local-6989586621679127602"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">CardSet
</span><a href="#local-6989586621679127601"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">CardSet -&gt; Bool
</span><a href="#local-6989586621679127602"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">CardSet
</span><a href="#local-6989586621679127600"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[Card] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Player -&gt; [Card]
</span><a href="State.html#cards"><span class="hs-identifier hs-var">cards</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127612"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Player
</span><a href="Moves.html#currPlayer"><span class="hs-identifier hs-var">currPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127612"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[Card] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Player -&gt; [Card]
</span><a href="State.html#cards"><span class="hs-identifier hs-var">cards</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127612"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Player
</span><a href="Moves.html#currPlayer"><span class="hs-identifier hs-var">currPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127612"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">6</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="hs-number">5</span></span><span>
</span><span id="line-178"></span><span>          </span><span id="local-6989586621679127602"><span class="annot"><span class="annottext">t :: CardSet -&gt; Bool
</span><a href="#local-6989586621679127602"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameElements.html#Wild"><span class="hs-identifier hs-type">Wild</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-179"></span><span>          </span><span class="annot"><a href="#local-6989586621679127602"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GameElements.html#Wild"><span class="hs-identifier hs-type">Wild</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-180"></span><span>          </span><span class="annot"><a href="#local-6989586621679127602"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GameElements.html#Wild"><span class="hs-identifier hs-type">Wild</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-181"></span><span>          </span><span class="annot"><a href="#local-6989586621679127602"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127599"><span class="annot"><span class="annottext">x :: Card
</span><a href="#local-6989586621679127599"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127598"><span class="annot"><span class="annottext">y :: Card
</span><a href="#local-6989586621679127598"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127597"><span class="annot"><span class="annottext">z :: Card
</span><a href="#local-6989586621679127597"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127599"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Card -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127598"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127598"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Card -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127597"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127599"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Card -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127598"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127599"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Card -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127597"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127598"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Card -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127597"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>          </span><span id="local-6989586621679127609"><span class="annot"><span class="annottext">useCards :: TradeIn -&gt; GameState -&gt; GameState
</span><a href="#local-6989586621679127609"><span class="hs-identifier hs-var hs-var">useCards</span></a></span></span><span> </span><span class="annot"><a href="GameElements.html#None"><span class="hs-identifier hs-type">None</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; GameState
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-183"></span><span>          </span><span class="annot"><a href="#local-6989586621679127609"><span class="hs-identifier hs-var">useCards</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameElements.html#OneSet"><span class="hs-identifier hs-type">OneSet</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127596"><span class="annot"><span class="annottext">x :: Card
</span><a href="#local-6989586621679127596"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127595"><span class="annot"><span class="annottext">y :: Card
</span><a href="#local-6989586621679127595"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127594"><span class="annot"><span class="annottext">z :: Card
</span><a href="#local-6989586621679127594"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player -&gt; Card -&gt; GameState -&gt; GameState
</span><a href="State.html#useCard"><span class="hs-identifier hs-var">useCard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Player
</span><a href="Moves.html#currPlayer"><span class="hs-identifier hs-var">currPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127612"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127596"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player -&gt; Card -&gt; GameState -&gt; GameState
</span><a href="State.html#useCard"><span class="hs-identifier hs-var">useCard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Player
</span><a href="Moves.html#currPlayer"><span class="hs-identifier hs-var">currPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127612"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127595"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player -&gt; Card -&gt; GameState -&gt; GameState
</span><a href="State.html#useCard"><span class="hs-identifier hs-var">useCard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Player
</span><a href="Moves.html#currPlayer"><span class="hs-identifier hs-var">currPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127612"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679127594"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>          </span><span class="annot"><a href="#local-6989586621679127609"><span class="hs-identifier hs-var">useCards</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameElements.html#TwoSet"><span class="hs-identifier hs-type">TwoSet</span></a></span><span> </span><span id="local-6989586621679127593"><span class="annot"><span class="annottext">s1 :: CardSet
</span><a href="#local-6989586621679127593"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621679127592"><span class="annot"><span class="annottext">s2 :: CardSet
</span><a href="#local-6989586621679127592"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TradeIn -&gt; GameState -&gt; GameState
</span><a href="#local-6989586621679127609"><span class="hs-identifier hs-var">useCards</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardSet -&gt; TradeIn
</span><a href="GameElements.html#OneSet"><span class="hs-identifier hs-var">OneSet</span></a></span><span> </span><span class="annot"><span class="annottext">CardSet
</span><a href="#local-6989586621679127593"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TradeIn -&gt; GameState -&gt; GameState
</span><a href="#local-6989586621679127609"><span class="hs-identifier hs-var">useCards</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardSet -&gt; TradeIn
</span><a href="GameElements.html#OneSet"><span class="hs-identifier hs-var">OneSet</span></a></span><span> </span><span class="annot"><span class="annottext">CardSet
</span><a href="#local-6989586621679127592"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>          </span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-comment">-- |Must be during the 'Attack' 'Normal' 'MiniPhase'. Should update phase to 'Fortify'.</span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><a href="Moves.html#endAttack"><span class="hs-identifier hs-type">endAttack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span>
</span><span id="line-188"></span><span>  </span><span id="endAttack"><span class="annot"><span class="annottext">endAttack :: GameState -&gt; Maybe GameState
</span><a href="Moves.html#endAttack"><span class="hs-identifier hs-var hs-var">endAttack</span></a></span></span><span> </span><span id="local-6989586621679127591"><span class="annot"><span class="annottext">gs :: GameState
</span><a href="#local-6989586621679127591"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Phase -&gt; Maybe GameState
</span><a href="#local-6989586621679127590"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Phase
</span><a href="State.html#phase"><span class="hs-identifier hs-var">phase</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127591"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679127590"><span class="annot"><span class="annottext">f :: Phase -&gt; Maybe GameState
</span><a href="#local-6989586621679127590"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="State.html#Attack"><span class="hs-identifier hs-type">Attack</span></a></span><span> </span><span class="annot"><a href="State.html#Normal"><span class="hs-identifier hs-type">Normal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Maybe GameState
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; GameState
</span><a href="State.html#nextPhase"><span class="hs-identifier hs-var">nextPhase</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127591"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>          </span><span class="annot"><a href="#local-6989586621679127590"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GameState
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-191"></span><span>          </span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-comment">-- |Moves troops from one country to another. Countries must be neighbours and owned by the current player. Must be during the correct phase. Troops are sent from the first country to the second one. Should update phase to 'Reinforce' and call nextTurn.</span><span>
</span><span id="line-193"></span><span>  </span><span class="annot"><a href="Moves.html#fortify"><span class="hs-identifier hs-type">fortify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="RiskBoard.html#Country"><span class="hs-identifier hs-type">Country</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="RiskBoard.html#Country"><span class="hs-identifier hs-type">Country</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span id="fortify"><span class="annot"><span class="annottext">fortify :: Country -&gt; Country -&gt; Int -&gt; GameState -&gt; Maybe GameState
</span><a href="Moves.html#fortify"><span class="hs-identifier hs-var hs-var">fortify</span></a></span></span><span> </span><span id="local-6989586621679127589"><span class="annot"><span class="annottext">cFrom :: Country
</span><a href="#local-6989586621679127589"><span class="hs-identifier hs-var">cFrom</span></a></span></span><span> </span><span id="local-6989586621679127588"><span class="annot"><span class="annottext">cTo :: Country
</span><a href="#local-6989586621679127588"><span class="hs-identifier hs-var">cTo</span></a></span></span><span> </span><span id="local-6989586621679127587"><span class="annot"><span class="annottext">nTroops :: Int
</span><a href="#local-6989586621679127587"><span class="hs-identifier hs-var">nTroops</span></a></span></span><span> </span><span id="local-6989586621679127586"><span class="annot"><span class="annottext">gs :: GameState
</span><a href="#local-6989586621679127586"><span class="hs-identifier hs-var">gs</span></a></span></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679127585"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Maybe GameState
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; Maybe GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; Maybe GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; GameState
</span><a href="State.html#nextTurn"><span class="hs-identifier hs-var">nextTurn</span></a></span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Country -&gt; Int -&gt; GameState -&gt; GameState
</span><a href="State.html#changeTroops"><span class="hs-identifier hs-var">changeTroops</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127589"><span class="hs-identifier hs-var">cFrom</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679127587"><span class="hs-identifier hs-var">nTroops</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GameState -&gt; GameState)
-&gt; (GameState -&gt; GameState) -&gt; GameState -&gt; GameState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Country -&gt; Int -&gt; GameState -&gt; GameState
</span><a href="State.html#changeTroops"><span class="hs-identifier hs-var">changeTroops</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127588"><span class="hs-identifier hs-var">cTo</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679127587"><span class="hs-identifier hs-var">nTroops</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127586"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GameState
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679127585"><span class="annot"><span class="annottext">valid :: Bool
</span><a href="#local-6989586621679127585"><span class="hs-identifier hs-var hs-var">valid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Phase
</span><a href="State.html#phase"><span class="hs-identifier hs-var">phase</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127586"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Phase -&gt; Phase -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="State.html#Fortify"><span class="hs-identifier hs-var">Fortify</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-198"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679127587"><span class="hs-identifier hs-var">nTroops</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Int
</span><a href="State.html#troops"><span class="hs-identifier hs-var">troops</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127586"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127589"><span class="hs-identifier hs-var">cFrom</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-199"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679127587"><span class="hs-identifier hs-var">nTroops</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-200"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Player
</span><a href="State.html#owner"><span class="hs-identifier hs-var">owner</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127586"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127589"><span class="hs-identifier hs-var">cFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Player
</span><a href="Moves.html#currPlayer"><span class="hs-identifier hs-var">currPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127586"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-201"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; Country -&gt; Player
</span><a href="State.html#owner"><span class="hs-identifier hs-var">owner</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127586"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127588"><span class="hs-identifier hs-var">cTo</span></a></span><span> </span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Player
</span><a href="Moves.html#currPlayer"><span class="hs-identifier hs-var">currPlayer</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127586"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-202"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127588"><span class="hs-identifier hs-var">cTo</span></a></span><span> </span><span class="annot"><span class="annottext">Country -&gt; Country -&gt; Bool
</span><a href="RiskBoard.html#isNeighbour"><span class="hs-operator hs-var">`isNeighbour`</span></a></span><span> </span><span class="annot"><span class="annottext">Country
</span><a href="#local-6989586621679127589"><span class="hs-identifier hs-var">cFrom</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>                  </span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-comment">-- |Must be during the correct phase. Should update phase to Reinforce and call nextTurn.</span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><a href="Moves.html#skipFortify"><span class="hs-identifier hs-type">skipFortify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="State.html#GameState"><span class="hs-identifier hs-type">GameState</span></a></span><span>
</span><span id="line-206"></span><span>  </span><span id="skipFortify"><span class="annot"><span class="annottext">skipFortify :: GameState -&gt; Maybe GameState
</span><a href="Moves.html#skipFortify"><span class="hs-identifier hs-var hs-var">skipFortify</span></a></span></span><span> </span><span id="local-6989586621679127582"><span class="annot"><span class="annottext">gs :: GameState
</span><a href="#local-6989586621679127582"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Phase
</span><a href="State.html#phase"><span class="hs-identifier hs-var">phase</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127582"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Phase -&gt; Phase -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="State.html#Fortify"><span class="hs-identifier hs-var">Fortify</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GameState -&gt; Maybe GameState
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GameState -&gt; GameState
</span><a href="State.html#nextTurn"><span class="hs-identifier hs-var">nextTurn</span></a></span><span> </span><span class="annot"><span class="annottext">GameState
</span><a href="#local-6989586621679127582"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GameState
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-------------------------------------------------------------------------------------------------------</span><span>
</span><span id="line-210"></span></pre></body></html>